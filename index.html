<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description"
          content=".">
    <meta name="keywords"
          content="NormalCrafter: Learning Temporally Consistent Normals
          from Video Diffusion Priors">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>NormalCrafter</title>

    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
          rel="stylesheet">

    <link rel="stylesheet" href="./static/css/bulma.min.css">
    <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="./static/css/twentytwenty.css">

    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="./static/css/index.css">
    <!-- <link rel="icon" href="./img/logo.png"> -->


    <script src="./static/js/jquery-3.2.1.min.js"></script>
    <script src="./static/js/jquery.event.move.js"></script>
    <script src="./static/js/jquery.twentytwenty.js"></script>
    <script src="./static/js/bulma-carousel.min.js"></script>
    <script src="./static/js/bulma-slider.min.js"></script>
    <script src="./static/js/fontawesome.all.min.js"></script>
</head>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LKCDBW8851"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-LKCDBW8851');
</script>


<body>
    <section class="hero teaser">
        <div class="hero-body">
            <div class="container is-max-desktop has-text-centered">
                <div class="columns is-centered">
                    <div class="column has-text-centered">
                        <!-- <img src="img/logo.png" style="height:170px; margin-bottom: -10px;"></img> -->
                        <h1 class="title is-1 publication-title has-text-centered">
                            NormalCrafter: Learning Temporally Consistent Normals from Video Diffusion Priors
                        </h1>
                        <!-- <h2 class="title publication-title is-4 has-text-grey"> Arxiv </h2> -->
                        <div class="is-size-5 publication-authors">
                            <span class="author-block">
                                <a href="https://scholar.google.com/citations?user=_9fN3mEAAAAJ&hl=zh-CN">Yanrui Bin</a><sup>1</sup>
                            </span>

                            <span class="author-block">
                                <a href="https://wbhu.github.io">Wenbo Hu</a><sup>2*</sup>
                            </span>
                            
                            <span class="author-block">
                                <a href="https://www.whyy.site/">Haoyuan Wang</a><sup>3</sup>
                            </span>
                            <span class="author-block">
                                <a href="https://xinyachen21.github.io/">Xinya Chen</a><sup>4</sup>
                            </span>
                            <span class="author-block">
                                <a href="https://www.polyu.edu.hk/aae/people/academic-staff/dr-wang-bing/">Bing Wang</a><sup>1 &dagger;</sup>
                            </span>
                            <br>
                            
                        </div>
                        <div class="is-size-5 publication-authors">
                            <span class="author-block"><sup>1</sup>Spatial Intelligence Group, The Hong Kong Polytechnic University</span>
                            <span class="author-block"><sup>2</sup>Tencent AI Lab</span>
                            <span class="author-block"><sup>3</sup>City University of Hong Kong</span>
                            <span class="author-block"><sup>4</sup>Huazhong University of Science and Technology</span>
                        </div>
                        <div class="column has-text-centered">
                            <div class="publication-links">
                                <span class="link-block">
                                    <!-- Paper Link. -->
                                    <a href="https://arxiv.org/abs/123"
                                       class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <i class="ai ai-arxiv"></i>
                                        </span>
                                        <span>arXiv</span>
                                    </a>
                                    <!-- Code Link. -->
                                    <a href="https://github.com/Binyr/NormalCrafter"
                                       class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <i class="fab fa-github"></i>
                                        </span>
                                        <span>Code</span>
                                    </a>
                                    <!-- HF Link. -->
                                    <a href="https://huggingface.co/spaces/Yanrui95/NormalCrafter" target="_blank"
                                       rel="noopener noreferrer" class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            &#129303;
                                        </span>
                                        <span>Hugging Face Demo</span>
                                    </a>
                                    <!-- Model Link. -->
                                    <a href="https://huggingface.co/Yanrui95/NormalCrafter" target="_blank"
                                       rel="noopener noreferrer" class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                           <i class="fas fa-dumbbell"></i>
                                        </span>
                                        <span>Model</span>
                                    </a>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>




<script>
    $(window).on('load', function () {
        bulmaCarousel.attach('#results-carousel-horizontal', {
            slidesToScroll: 1,
            slidesToShow: 1,
            loop: true,
            autoplay: false,
        });

        bulmaCarousel.attach('#results-carousel-vertical', {
            slidesToScroll: 1,
            slidesToShow: 1,
            loop: true,
            autoplay: false,
        });

    });
</script>

<br><br><br>

<section class="hero teaser">
    <div class="hero-body">
        <!-- Method. -->
        <div class="columns is-centered has-text-centered">
            <div class="columns is-centered has-text-centered">
                <div class="column is-three-fifths" style=" margin-top: 30px; margin-bottom: 20px;">
                    <h2 class="title is-3">Brief introduction</h2>
                    <div class="content has-text-justified">

                        <b>Abstract.</b>
                        Surface normal estimation serves as a cornerstone for a spectrum of computer vision applications.
                        While numerous efforts have been devoted to static image scenarios, ensuring temporal coherence 
                        in video-based normal estimation remains a formidable challenge.
                        Instead of merely augmenting existing methods with temporal components, we present NormalCrafter 
                        to leverage the inherent temporal priors of video diffusion models.
                        To secure high-fidelity normal estimation across sequences, we propose 
                        Semantic Feature Regularization (SFR), which aligns diffusion features with semantic cues, 
                        encouraging the model to concentrate on the intrinsic semantics of the scene.
                        Moreover, we introduce a two-stage training protocol that leverages both latent and pixel space 
                        learning to preserve spatial accuracy while maintaining long temporal context.
                        Extensive evaluations demonstrate the efficacy of our method, showcasing a superior performance 
                        in generating temporally consistent normal sequences with intricate details from diverse videos.

                        <div class="hero-body" style="margin-top: 40px; margin-bottom: -30px;">
                            <img id="overview" width="90%" src="img/pipeline.png"/>
                        </div>
                        <b>Overview.</b>
                        We model the video normal estimation task with a video diffusion model conditioned on input
                        RGB frames.
                        We propose Semantic Feature Regularization (SFR) L<sub>reg</sub> to align the diffusion features with robust 
                        semantic representations from DINO encoder, encouraging the model to concentrate on the 
                        intrinsic semantics for accurate and detailed normal estimation.
                        Our training protocol consists of two stages: 1. training the entire U-Net in the latent space 
                        with diffusion score matching L<sub>DSM</sub> and SFR L<sub>reg</sub>; 2. fine-tuning only the spatial layers in pixel 
                        space with angular loss L<sub>angular</sub> and SFR L<sub>reg</sub>.
                        
                    </div>
                </div>

            </div>
        </div>
        <!--/ Method. -->
    </div>
</section>

<section class="hero teaser is-light is-small">
    <div class="hero-body">
        <div class="container" style="text-align: center; ">
            <h2 class="title is-3">Comparison with Baselines on Sora videos</h2>
            <div id="cmp-gt-carousel-horizontal" class="carousel results-carousel">


                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="video/sora/robot_video_game.mp4" type="video/mp4">
                </video>

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="video/sora/Tokyo_Walk.mp4" type="video/mp4">
                </video>

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="video/sora/cat_on_bed.mp4" type="video/mp4">
                </video>

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="video/sora/aquariumnyc.mp4" type="video/mp4">
                </video>

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="video/sora/BigSur.mp4" type="video/mp4">
                </video>

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="video/sora/birdsoverriver.mp4" type="video/mp4">
                </video>

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="video/sora/chairarchaeology.mp4" type="video/mp4">
                </video>

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="video/sora/eat_burger.mp4" type="video/mp4">
                </video>

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="video/sora/example_05.mp4.mp4" type="video/mp4">
                </video>

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="video/sora/flowerblooming.mp4" type="video/mp4">
                </video>

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="video/sora/grandmabirthday.mp4" type="video/mp4">
                </video>

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="video/sora/lagos.mp4" type="video/mp4">
                </video>

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="video/sora/ShipsinCoffee.mp4" type="video/mp4">
                </video>

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="video/sora/SUVintheDust.mp4" type="video/mp4">
                </video>

            </div>


        </div>
    </div>
</section>

<script>
    $(window).on('load', function () {
        bulmaCarousel.attach('#cmp-gt-carousel-horizontal', {
            slidesToScroll: 1,
            slidesToShow: 1,
            loop: true,
            autoplay: false,
        });

    });
</script>

<section class="hero teaser is-light is-small">
    <div class="hero-body">
        <div class="container" style="text-align: center; ">
            <h2 class="title is-3">Comparison with Baselines on DAVIS dataset</h2>
            <div id="cmp-gt-carousel-horizontal" class="carousel results-carousel">

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="./video/comparison/breakdance.mp4" type="video/mp4">
                </video>
                <!-- <br><br> -->

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="./video/comparison/butterfly.mp4" type="video/mp4">
                </video>
                <!-- <br><br> -->

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="./video/comparison/bike-trial.mp4" type="video/mp4">
                </video>
                <!-- <br><br> -->

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="./video/comparison/boat.mp4 " type="video/mp4">
                </video>
                <!-- <br><br> -->

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="./video/comparison/dancing.mp4" type="video/mp4">
                </video>
                <!-- <br><br> -->

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="./video/comparison/elephant.mp4" type="video/mp4">
                </video>
                <!-- <br><br> -->

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="./video/comparison/hike.mp4" type="video/mp4">
                </video>
                <!-- <br><br> -->

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="./video/comparison/inflatable.mp4" type="video/mp4">
                </video>
                <!-- <br><br> -->

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="./video/comparison/basketball-game.mp4" type="video/mp4">
                </video>
                <!-- <br><br> -->

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="./video/comparison/camel.mp4" type="video/mp4">
                </video>
                <!-- <br><br> -->

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="./video/comparison/horsejump-stick.mp4" type="video/mp4">
                </video>
                <!-- <br><br> -->

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="./video/comparison/breakdance-flare.mp4" type="video/mp4">
                </video>
                <!-- <br><br> -->
                
                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="./video/comparison/dance-jump.mp4" type="video/mp4">
                </video>
                <!-- <br><br> -->

                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="./video/comparison/e-bike.mp4" type="video/mp4">
                </video>
                <!-- <br><br> -->


                <video muted autoplay="autoplay" loop="loop" width="100%" preload controls>
                    <source src="./video/comparison/dance-twirl.mp4" type="video/mp4">
                </video>
                <!-- <br><br> -->

                

            </div>


        </div>
    </div>
</section>



<!-- <section class="hero teaser is-light is-small">
    <div class="hero-body">

        <div class="container" style="text-align: center; ">
            <h2 class="title is-3">Comparison with Depth-Anything-V2 on open-world videos</h2>
            <div id="comparison-carousel-horizontal" class="carousel results-carousel">

                <div class="twoitem">
                    <video muted autoplay="autoplay" loop="loop" width="100%">
                        <source src="video/comparison/horsejump-high.mp4" type="video/mp4">
                    </video>
                    <div class="twentytwenty-container twentytwenty-container-bottom">
                        <div class="cmpcontent">
                            <video muted autoplay="autoplay" loop="loop" width="100%">
                                <source src="video/comparison/horsejump-high-da2.mp4" type="video/mp4">
                            </video>
                        </div>
                        <div class="cmpcontent">
                            <video muted autoplay="autoplay" loop="loop" width="100%">
                                <source src="video/comparison/horsejump-high-ours.mp4" type="video/mp4">
                            </video>
                        </div>
                    </div>
                </div>

                <div class="twoitem">
                    <video muted autoplay="autoplay" loop="loop" width="100%">
                        <source src="video/comparison/camel.mp4" type="video/mp4">
                    </video>
                    <div class="twentytwenty-container twentytwenty-container-bottom">
                        <div class="cmpcontent">
                            <video muted autoplay="autoplay" loop="loop" width="100%">
                                <source src="video/comparison/camel-da2.mp4" type="video/mp4">
                            </video>
                        </div>
                        <div class="cmpcontent">
                            <video muted autoplay="autoplay" loop="loop" width="100%">
                                <source src="video/comparison/camel-ours.mp4" type="video/mp4">
                            </video>
                        </div>
                    </div>
                </div>

                <div class="twoitem">
                    <video muted autoplay="autoplay" loop="loop" width="100%">
                        <source src="video/comparison/kite-walk.mp4" type="video/mp4">
                    </video>
                    <div class="twentytwenty-container twentytwenty-container-bottom">
                        <div class="cmpcontent">
                            <video muted autoplay="autoplay" loop="loop" width="100%">
                                <source src="video/comparison/kite-walk-da2.mp4" type="video/mp4">
                            </video>
                        </div>
                        <div class="cmpcontent">
                            <video muted autoplay="autoplay" loop="loop" width="100%">
                                <source src="video/comparison/kite-walk-ours.mp4" type="video/mp4">
                            </video>
                        </div>
                    </div>
                </div>

                <div class="twoitem">
                    <video muted autoplay="autoplay" loop="loop" width="100%">
                        <source src="video/comparison/scooter-black.mp4" type="video/mp4">
                    </video>
                    <div class="twentytwenty-container twentytwenty-container-bottom">
                        <div class="cmpcontent">
                            <video muted autoplay="autoplay" loop="loop" width="100%">
                                <source src="video/comparison/scooter-black-da2.mp4" type="video/mp4">
                            </video>
                        </div>
                        <div class="cmpcontent">
                            <video muted autoplay="autoplay" loop="loop" width="100%">
                                <source src="video/comparison/scooter-black-ours.mp4" type="video/mp4">
                            </video>
                        </div>
                    </div>
                </div>

                <div class="twoitem">
                    <video muted autoplay="autoplay" loop="loop" width="100%">
                        <source src="video/comparison/closeup-main_combined.mp4" type="video/mp4">
                    </video>
                    <div class="twentytwenty-container twentytwenty-container-bottom">
                        <div class="cmpcontent">
                            <video muted autoplay="autoplay" loop="loop" width="100%">
                                <source src="video/comparison/closeup-main_combined-da2.mp4" type="video/mp4">
                            </video>
                        </div>
                        <div class="cmpcontent">
                            <video muted autoplay="autoplay" loop="loop" width="100%">
                                <source src="video/comparison/closeup-main_combined-ours.mp4" type="video/mp4">
                            </video>
                        </div>
                    </div>
                </div>

                <div class="twoitem">
                    <video muted autoplay="autoplay" loop="loop" width="100%">
                        <source src="video/comparison/5442785-hd_1920_1080_25fps_combined.mp4" type="video/mp4">
                    </video>
                    <div class="twentytwenty-container twentytwenty-container-bottom">
                        <div class="cmpcontent">
                            <video muted autoplay="autoplay" loop="loop" width="100%">
                                <source src="video/comparison/5442785-hd_1920_1080_25fps_combined-da2.mp4"
                                        type="video/mp4">
                            </video>
                        </div>
                        <div class="cmpcontent">
                            <video muted autoplay="autoplay" loop="loop" width="100%">
                                <source src="video/comparison/5442785-hd_1920_1080_25fps_combined-ours.mp4"
                                        type="video/mp4">
                            </video>
                        </div>
                    </div>
                </div>


                <div class="twoitem">
                    <video muted autoplay="autoplay" loop="loop" width="100%">
                        <source src="video/comparison/10714343-hd_3840_2160_30fps_combined.mp4" type="video/mp4">
                    </video>
                    <div class="twentytwenty-container twentytwenty-container-bottom">
                        <div class="cmpcontent">
                            <video muted autoplay="autoplay" loop="loop" width="100%">
                                <source src="video/comparison/10714343-hd_3840_2160_30fps_combined-da2.mp4"
                                        type="video/mp4">
                            </video>
                        </div>
                        <div class="cmpcontent">
                            <video muted autoplay="autoplay" loop="loop" width="100%">
                                <source src="video/comparison/10714343-hd_3840_2160_30fps_combined-ours.mp4"
                                        type="video/mp4">
                            </video>
                        </div>
                    </div>
                </div>

                <div class="twoitem">
                    <video muted autoplay="autoplay" loop="loop" width="100%">
                        <source src="video/comparison/longmao_02_combined.mp4" type="video/mp4">
                    </video>
                    <div class="twentytwenty-container twentytwenty-container-bottom">
                        <div class="cmpcontent">
                            <video muted autoplay="autoplay" loop="loop" width="100%">
                                <source src="video/comparison/longmao_02_combined-da2.mp4" type="video/mp4">
                            </video>
                        </div>
                        <div class="cmpcontent">
                            <video muted autoplay="autoplay" loop="loop" width="100%">
                                <source src="video/comparison/longmao_02_combined-ours.mp4" type="video/mp4">
                            </video>
                        </div>
                    </div>
                </div>

                <div class="twoitem">
                    <video muted autoplay="autoplay" loop="loop" width="100%">
                        <source src="video/comparison/wukong2_combined.mp4" type="video/mp4">
                    </video>
                    <div class="twentytwenty-container twentytwenty-container-bottom">
                        <div class="cmpcontent">
                            <video muted autoplay="autoplay" loop="loop" width="100%">
                                <source src="video/comparison/wukong2_combined-da2.mp4" type="video/mp4">
                            </video>
                        </div>
                        <div class="cmpcontent">
                            <video muted autoplay="autoplay" loop="loop" width="100%">
                                <source src="video/comparison/wukong2_combined-ours.mp4" type="video/mp4">
                            </video>
                        </div>
                    </div>
                </div>

                <div class="twoitem">
                    <video muted autoplay="autoplay" loop="loop" width="100%">
                        <source src="video/comparison/wukong_combined.mp4" type="video/mp4">
                    </video>
                    <div class="twentytwenty-container twentytwenty-container-bottom">
                        <div class="cmpcontent">
                            <video muted autoplay="autoplay" loop="loop" width="100%">
                                <source src="video/comparison/wukong_combined-da2.mp4" type="video/mp4">
                            </video>
                        </div>
                        <div class="cmpcontent">
                            <video muted autoplay="autoplay" loop="loop" width="100%">
                                <source src="video/comparison/wukong_combined-ours.mp4" type="video/mp4">
                            </video>
                        </div>
                    </div>
                </div>

                <div class="twoitem">
                    <img id="cmp1" width="100%" src="./img/img01.jpg"/>

                    <div class="twentytwenty-container twentytwenty-container-bottom">
                        <div class="cmpcontent">
                            <img id="cmp1-da2" width="100%" src="./img/img01-da2.jpg"/>
                        </div>
                        <div class="cmpcontent">
                            <img id="cmp1-ours" width="100%" src="./img/img01-ours.jpg"/>
                        </div>
                    </div>
                </div>
                <div class="twoitem">
                    <img id="cmp2" width="100%" src="./img/img02.jpg"/>

                    <div class="twentytwenty-container twentytwenty-container-bottom">
                        <div class="cmpcontent">
                            <img id="cmp2-da2" width="100%" src="./img/img02-da2.jpg"/>
                        </div>
                        <div class="cmpcontent">
                            <img id="cmp2-ours" width="100%" src="./img/img02-ours.jpg"/>
                        </div>
                    </div>
                </div>


            </div>
        </div>
    </div>
</section>


<script>
    $(window).on('load', function () {
        bulmaCarousel.attach('#comparison-carousel-horizontal', {
            slidesToScroll: 2,
            slidesToShow: 2,
            loop: true,
            autoplay: false,
        });

        $(".twentytwenty-container-bottom").twentytwenty({
            before_label: 'Depth-Anything-V2',
            after_label: 'Ours',
            default_offset_pct: 0.3,
            no_overlay: false,
            // move_slider_on_hover: true,
        });

    });
</script>


<script>
    $(window).on('load', function () {
        bulmaCarousel.attach('#nvs-carousel-horizontal', {
            slidesToScroll: 2,
            slidesToShow: 2,
            loop: true,
            autoplay: false,
        });

        $(".twentytwenty-container-nvs").twentytwenty({
            before_label: 'Input view',
            after_label: 'Novel view',
            default_offset_pct: 0.3,
            no_overlay: false,
            // move_slider_on_hover: true,
        });

    });
</script>


<script>
    $(window).on('load', function () {
        bulmaCarousel.attach('#editting-carousel-horizontal', {
            slidesToScroll: 2,
            slidesToShow: 2,
            loop: true,
            autoplay: false,
        });

        $(".twentytwenty-container-editting").twentytwenty({
            before_label: 'W/ Depth-Anything-V2',
            after_label: 'W/ Ours',
            default_offset_pct: 0.3,
            no_overlay: false,
            // move_slider_on_hover: true,
        });

    });
</script> -->




<footer class="footer">
    <div class="hero-body">
        <div class="columns is-two-fifths is-centered">
            <div class="column is-8">
                <div class="content">
                    <p>
                        Website template credit to <a
                            href="https://github.com/nerfies/nerfies.github.io">Nerfies</a>, and is licensed under a <a
                            rel="license"
                            href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
                        Commons Attribution-ShareAlike 4.0 International License</a>.
                    </p>
                </div>
            </div>
        </div>
    </div>
</footer>

</body>
</html>
